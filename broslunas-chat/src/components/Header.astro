---
import { parse } from 'cookie';

const cookies = parse(Astro.request.headers.get('cookie') || '');
const isLoggedIn = cookies['loggedIn'] === 'true';
const isHomePage = Astro.url.pathname === '/';

const menu = [
	{
		link: '/login/',
		label: 'Login',
		hidden: isLoggedIn, // Hide if logged in
	},
	{
		link: '/register/',
		label: 'Registro',
		hidden: isLoggedIn, // Hide if logged in
	},
];
---

<header id='site-header'>
	<div class='container'>
		<nav class='nav'>
			{isHomePage && (
				<div class='logo-container'>
					<h2 class='logo'>
						<a href='/'>
							<img src='https://cdn.broslunas.com/favicon.png' alt='Broslunas Logo' class='logo-image' />
							Broslunas Chat
						</a>
					</h2>
				</div>
			)}
		</nav>
		<div class='menu-container'>
			<div class='menu'>
				<div class='menu-item'>
					<a href='/' aria-label='Home'>
						<svg
							xmlns='http://www.w3.org/2000/svg'
							width='20'
							height='20'
							viewBox='0 0 24 24'
							fill='none'
							stroke='currentColor'
							stroke-width='1.7'
							stroke-linecap='round'
							stroke-linejoin='round'
							class='lucide lucide-house'
						>
							<path d='M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8'></path>
							<path d='M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'></path>
						</svg>
					</a>
				</div>
				{
					menu
						.filter((item) => !item.hidden) // Filter out hidden links
						.map((item) => (
							<div class='menu-item'>
								<a href={item.link}>
									{item.label}
								</a>
							</div>
						))
				}
			</div>
		</div>
	</div>

	<style is:global>

		.container {
			width: 100%;
			margin: 0 auto;
    }

		.nav {
			display: block; /* Ensure the logo container takes full width */
		}

		.github-links {
			display: flex;
		}

		.github-light {
			padding: 12px;
		}

		.github-dark {
			padding: 12px;
			display: none;
		}

		.menu-container {
			position: fixed;
			top: 12px;
			left: 50%;
			transform: translateX(-50%);
			width: auto;
			max-width: 100%;
			padding: 12px;
			z-index: 999;
		}

		.menu {
			display: flex;
			padding: 8px;
			background: rgba(255, 244, 230, 0.9);
			backdrop-filter: blur(10px);
			border-radius: 999px;
			border: 1px solid rgba(255, 140, 66, 0.5);
		}

		.menu-item {
			padding: 8px;
			font-size: 0.875rem;
			color: #663c00;
		}

		.menu-item a {
			color: #663c00;
			text-decoration: none;
		}

		.menu-item a:hover {
			color: #ff8c42;
		}

		#site-header {
			background-color: #1a1a1a;
			color: #ffffff;
		}
		
    .logo-container {
			width: 100%;
			text-align: left;
			margin-bottom: 16px;
		}

			.logo {
			display: flex;
			align-items: center;
			font-size: 1.5rem;
			font-weight: bold;
		}

		.logo a {
			color: #ffffff;
			text-decoration: none;
			display: flex;
			align-items: center;
		}

		.logo a:hover {
			color: #ff8c42;
		}

		.logo-image {
			height: 1em;
			margin-right: 8px;
		}

		.menu {
			background: rgba(39, 39, 39, 0.75);
			border-color: rgba(39, 39, 39, 0.5);
		}

		.menu-item {
			color: #ffffff;
		}

		.menu-item a {
			color: #ffffff;
		}

		.menu-item a:hover {
			color: #ff8c42;
		}

		.github-light {
			display: none;
		}

		.github-dark {
			display: block;
		}
	</style>


</header>
